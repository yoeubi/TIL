# React란?

리액트는 페이스북에서 개발한 UI 라이브러리이다.

리액트 같은 라이브러르를 사용하는 이유는 UI를 자동으로 업데이트 해준다는 점이다.

리액트를 사용하지 않으면 브라우저의 돔을 직접 업데이트 해야한다.

돔을 직접 업데이트 하는 코드는 잘 관리하지 않으면 프로그램이 커질수록 복잡도가 기하급수적으로 증가한다.

리액트의 장점은 가상 돔을 통해서 UI를 빠르게 업데이트 한다는 점이다.

가상 돔은 이전 UI 상태를 메모리에 유지해서 변경될 UI의 최소 집합을 계산하는 기술이다.

가상 돔덕분에 불필요한 UI 업데이트는 줄고 성능은 좋아진다.

리액트는 함수형 프로그래밍을 적극정으로 활용한다는 특징이 있다.

리액트는 다음과 같은 제약사항으 존재한다.

렌더 함수는 순수 함수로 작성해야 한다.

컴포넌트 상태값은 불변 객체로 관리해야 한다.

프로덕션 환경 파일, 개발 환경 파일이 존재한다.

개발 환경을 위한 파일을 사용하면 개발시 도움이 되는 에러 메세지를 확인할 수 있다.

## createElement 이해하기

React.createElement(component, props, ...children) => ReactElement

첫 번째 매개변수 component는 일반적으로 문자열이나 리액트 컴포넌트다.

문자열이면 HTML 태그에 해당하는 돔 요소가 생성된다.

두 번째 매개변수 props는 컴포넌트가 사용하는 데이터를 나타낸다.

돔 요소의 경우 style, className등의 데이터가 사용될 수 있다.

세 번째 매개변수 children은 해당 컴포넌트가 감싸고 있는 내부의 컴포넌트를 가리킨다.

일반적으로 babel의 도움을 받아서 JSX 문법을 사용한다.

## 바벨 사용해보기

babel은 자바스크립트 코드를 변환해주는 컴파일러다.

바벨을 사용하면 최신 자바스크립트 문법을 지원하지 않는 환경에서도 최신 문법을 사용할 수 있다.

바벨은 자바스크립트 최신 문법을 사용하는 용도 외에도 다양하게 활용될 수 있다.

코드에서 주석을 제거하거나 코드를 압축하는 용도로 사용될수 있다.

## JSX

HTML 태그와 가장 큰 차이점은 속성값을 작성하는 방법에 있다.

HTML에서 돔 요소에 CSS 클래스 이름을 부여할때 class 키워드를 사용했다면 JSX에서는 className 키워드를 사용한다.

이는 class라는 이름이 자바스크립트 class 키워드와 같기 때문이다.

JSX에서는 돔 요소와 리액트 컴포넌트를 같이 사용할 수 있다.

문자열 리터럴이 아닌 속성값은 중괄호를 사용해서 입력한다.

이벤트 처리 함수는 브라우저마다 다르게 동작할 수 있기 떄문에 리액트와 같은 라이브러리를 사용하지 않을 때는 주의해야 한다.

리액트에서는 이벤트 처리 함수를 호출할 때 브라우저에 상관없이 통일된 이벤트 객체(SyntheticEvent)를 전달해준다.

HTML에서 돔 요소에 직접 스타일을 적용하는 것과 같이 JSX에서도 스타일을 적용할 수 있다.

다만 자바스크립트에서 속성 이름에 대시로 연결되는 이름을 사용하는게 힘들기 때문에 카멜케이스를 사용한다.

## JSX문법을 바벨로 컴파일하기

JSX 문법은 자바스크립트 표준이 아니기 떄문에 그대로 실행하면 에러가 발생한다

바벨을 이용해서 JSX 문법으로 작성된 파일을 createElement 함수로 작성된 파일로 변환해야한다.

```js
npm install @babel/core @babel/cli @babel/preset-react
```

@babel/cli 는 커맨드 라인에서 바벨을 실행할수 있는 바이너리 파일이 들어 있다.

@babel/preset-react는 JSX로 작성된 코드를 createElement 함수를 이용한 코드를 변환해주는 바벨 플러그인이 있다.

## 바벨 플러그인과 프리셋

바벨은 자바스크립트 파일을 입력으로 받아서 또 다른 자바스크립트 파일을 출력으로 준다.

자바스크립트 파일을 변환해주는 작업은 플러그인 단위로 이루어진다.

하나의 목적을 위해 여러 개의 플러그인이 필요할 수 있는데 이러한 플러그인의 집합을 프리셋이라고 부른다.

```js
npx babel --watch src --out-dir . --presets @babel/preset-react
```

npx 명령어는 외부 패키지에 포함된 실행 파일을 실행할때 사용된다.

외부 패키지의 실행 파일은 ./node_modules/.bin/ 밑에 저장된다.

따라서 npx babel은 ./node_modules/.bin/babel을 입력하는 것과 비슷하다.

위 명령어를 실행하면 src 폴더에 있는 모든 자바스크립트 파일을 @babel/preset-react 프리셋을 이용해서 변환 후 현재 폴더에 같은 이름의 자바스크립트 파일을 생성한다.

watch 모드로 실행했기 때문에 src 폴더의 자바스크립트 파일을 수정할 때마다 자동으로 변환후 저장한다.

## 웹팩의 기본 개념 이해하기

웹팩은 자바스크립트로 만든 프로그램을 배포하기 좋은 형태로 묶어 주는 툴이다.

2000년대 초반의 웹 페이지는 페이지가 전환될 때마다 새로운 HTML 파일을 요청해서 화면을 새로 그리는 방식이였다.

그 당시 자바스크립트는 돔을 조작하는 간단한 역할만 했기 때문에 코드의 양이 많지 않았다.

웹사이트 제작 방식이 단일 페이지 애플리케이션으로 전환되면서 상황은 달라졌다.

한 페이지에 자바스크립트 파일 수십 또는 수 백개가 필요했기 때문에 기존 방식이 통할 리 없었다.

이런 방식으로는 계속 늘어나는 자바스크립트 파일을 관리하기 힘들다.

파일 간의 의존성때문에 선언되는 순서를 신경 써야 한다.

그리고 뒤에 선언된 자바스크립트 파일이 앞에 선언된 파일에서 생성된 전역 변수를 덮어 쓰는 위험도 존재한다.

## 자바스크립트의 모듈 시스템

java에서는 import 키워드를 이용해서 한 파일에서 다른 파일의 코드를 가져다 사용할 수 있다.

하나의 파일이 하나의 모듈이 되고 사용하는 쪽에서는 여러 모듈을 가져다 쓸 수 있다.

이때 모듈 측에서는 필요한 부분만 내보내는 방법이 필요하고 사용하는 측에서는 필요한 것만 가져다 쓸 방법이 필요하다.

이렇게 내보내고 가져다 쓸 수 있도록 구현된 시스템이 모듈 시스템이다.

자바스크립트에서는 ES6부터 모듈 시스템이 언어 차원에서 지원된다.

하지만 예전 버전의 브라우저에서는 사용할 수 없다.

상당 수의 많은 오픈소스가 ES6모듈로 작성되지 않았다.

ES6가 나오지 이전부터 자바스크립트의 모듈 시스템을 요구하는 개발자가 많았다.

그래서 등장한 대표적인 모듈 시스템이 commonJS이다.

//

웹팩은 ESM과 commonJS를 둘 다 지원한다.

이 모듈 시스템을 이용해서 코드를 작성하고 웹팩을 실행하면 예전 버전의 브라우저에서도 동작하는 자바스크립트 코드를 만들 수 있다.

웹팩을 실행하면 보통 하나의 자바스크립트 파일이 만들어지고, 원한다면 여러 개의 파일로 분할할 수도 있다.

## 웹팩 사용해보기

## 클래스형 컴포넌트와 함수형 컴포넌트

리액트 16.8 이전 버전의 함수형 컴포넌트가 할수 없는 일은 다음과 같다.

1. 상태값을 가질 수 없다.

1. 리액트 컴포넌트의 생명 주기 함수를 작성할 수 없다.

리액트 버전 16.8 부터 hook이라는 기능이 추가되면서 함수형 컴포넌트에서도 상태값과 생명주기 함수 코드를 작성 할 수 있게 되었다.

## create-react-app 으로 실행하기

create-react-app은 리액트로 웹 애플리케이션을 만들기 위한 환경을 제공한다.

바벨과 웹팩도 create-react-app에 포함되어 있다.

그 밖에 테스트 시스템, HMR, ES6+ 문법, CSS 후처리 등 거의 필수라고 할 수 있는 개발 환경도 구축해준다.

이러한 개발 환경을 직접 구축할 경우 시간이 오래 걸릴뿐 아니라 유지 보수도 해야 한다.

기존 기능을 개선하거나 새로운 기능을 추가했을 때 패키지 버전만 올리면 된다.

## create-react-app 사용해보기

create-react-app 패키지가 설치되어 있지 않더라도 npx가 자동으로 가져와서 실행한다.

npm start 실행 시 create-react-app이 로컬서버를 띄워 주기때문에 가능한 일이다.

참고로 npm start는 개발 모드에서 동작하므로 배포할 때 사용하면 안된다.

index.html, index.js는 빌드 시 예약된 파일 이름이므로 지우면 안된다.

index.js로부터 연결된 모든 자바스크립트 파일과 CSS 파일은 src 폴더 밑에 있어야 한다.

src 폴더 바깥에 있는 파일을 import 키워드를 이용해서 가져오려고 하면 실패한다.

index.html에서 참조하는 파일은 public 폴더 밑에 있어야 한다.

public 밑에 있는 자바스크립트 파일이나 CSS 파일을 link나 script 태그를 이용해서 index.html에 포함시킬 수 있다.

하지만 특별한 이유가 없다면 index.html에 직접 연결하는 것보다는 src 폴더 밑에서 impot 키워드를 사용해서 포함시키는게 좋다.

그래야 자바스크립트 파일이나 CSS 파일의 경우 빌드 시 자동으로 압축된다.

이미지 파일이나 폰트 파일의 경우도 마찬가지로 src 폴더 밑에서 import 키워드를 사용해서 포함시키는 게 좋다.

웹팩에서 해시값을 이용해서 url을 생성해주기 때문에 파일의 내용이 변경되지 않으면 브라우저 캐싱 효과를 볼 수 있다.

제목을 페이지별로 다르게 줘야 한다면 react-helmet과 같은 패키지를 사용하면 된다.

반대로 일반 사용자를 대상으로 하는 웹사이트라서 검색 엔진 최적화를 해야한다면 서버사이드 렌더링에 특화된 next.js를 사용하는게 좋다.

## 주요 명령어 알아보기

create-react-app에서는 https로 실행하는 옵션을 제공한다.

맥: HTTTPS=true npm start
윈도우: set HTTPS=true && npm start

## 빌드하기

파일의 내용이 변경되지 않으면 해시값은 항상 같다.

새로 빌드를 하더라도 변경되지 않은 파일은 브라우저에 캐싱되어 있는 파일이 사용된다.

이미지 파일의 크기가 10KB보다 작은 경우에는 별도의 파일로 생성되지 않고 data url 형식으로 자바스크립트 파일에 포함된다.

## 테스트 코드 실행하기

1. **test** 폴더 밑에 있는 모든 자바스크립트 파일
1. 파일 이름이 .test.js로 끝나는 파일
1.
