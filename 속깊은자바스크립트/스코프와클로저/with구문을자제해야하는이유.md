# with 구문을 자제해야 하는 이유

- 첫번째 이유는 스코프를 생성함으로서 생기는 추가 자원 소모이다.

- 새로운 인자로 들어온 스코프에서만 데이터와 함수들을 이용하면 성능이 향상되지만 , 스코프 체인 상위에 있는 스코프에서 데이터를 가져올 떄는 검색 시간과 자원 소모등 처리에 드는 비용이 추가된다.

- 즉, with 안의 구문들이 어떠한 구문들로 이루어졌느냐에 따라 성능이 차이가 다르게 나타날수 있다.

- 앞의 user 변수를 이용한 예에서 nickname의 값을 설정하고자 했을때 자바스크립트에서는 먼저 with(user)의 스코프를 1차로 탐색한 다음, user 객체에 nickname이 없음을 확인한다.

- 그다음 스코프 체인 상위에 있는 글로벌 영역의 변수들을 탐색한 뒤 글로벌 영역에도 없다는 것을 판단하고 나면 비로소 글로벌 영역에 변수로 설정하게 된다.

- 의도에 따라서 글로벌 영역을 탐색하고자 할때 with 구문이 있다면 탐색하야 하는 스코프가 하나 더 늘어나게 된 셈이다.

## with 구문을 사용한 소스의 모호성

```js
function doSomething(value , obj){
    with (obj){
        console.log(value);
        value = 'which scope is this';
    }
}
```

- value가 어떤 value를 말하는지 알수 있나? 첫번쨰는 파라미터의 value 인자이다. 혹은 obj 내부에 value가 있다면 obj.value 일 수도 있다.

- 이 두가지 중 어느 value인지 알려면 파라미터로 들어오는 obj의 구조부터 알아야 할것 이고 , 다른 사람이 짜놓은 소스라면 원 개발자의 의도가 무서인지 파악해야한다.

## ECMAScript6 표준에서 with 구문 제외

- ECMAScript6 표준에서는 with 구문이 제외(deprecate)될 예정이므로 미래의 브라우저에서는 정상으로 동작하지 않을 위험성이 많다.

## with 구문으로 DOM 스타일 설정 문제와 대안

- with를 이용해서 DOM의 스타일을 설정하는 소스는 효율적으로 보이는데 이것은 어떠한 위험성이 있을까?

- style에 설정되지 않았던 속성을 추가하고 싶을 떄는 with 구문으로 추가할수 있는 방법이 없다.

- 예를 들면 , 위의 style 예에서 기존에 border 속성이 설정되어 있지 않다면 , with 구문으로 style에 border를 설정하는 것이 아니라 , 글로벌 변수로 border를 선언해버리는 결과가 나오게 된다.

- style을 좀 더 편하게 설정하고 싶을때는 

```js
var s = document.getElementById('myDiv').style;
s.background = 'yellow';
s.color = 'red';
s.border = '1px solid black';
```

- DOM의 하위 속성인 style을 자체적으로 변수로 가지고 있으면서, 그 변수에 속성을 추가혀면 DOM의 style에 여러 가지 속성을 설정할수 있다.

- with보다 사용해야 하는 글자 수는 조금 더 많지만 , 아주 직관적이고 with처럼 다른 자바스크립트 개발자들이 혼란스러워할 만한 요소가 없다.

- 속성이 글로벌 변수로 튀어나가는 위험성도 없고 로컬 변수에 접근함으로써 상위 스코프에 저븐하는 것을 최소화하여 성능에 이저이 있을 수도 있다.

