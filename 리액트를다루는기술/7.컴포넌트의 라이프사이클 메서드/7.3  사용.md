# 7.3 사용

# 7.3.1 예제 컴포넌트 생성

src 디렉토리에 LifeCycleSample.js 컴포넌트를 만드세요

```js
class LifeCycleSample extends Component {
    state = {
        number : 0,
        color : null
    }
    myRef = null; 

    constructor(props){
        super(props);
        console.log('constructor')
    }
    static getDerivedStateFromProps(nextProps, prevState){
        if(nextProps.color !== prevState.color){
            return {color : nextProps.color}
        }
        return null;
    }
    componentDidMount(){
        console.log('componentDidMount');
    }
    shouldComponentUpdate(nextProps, nextState){
        console.log('shouldComponentUpdate', nextProps, nextState)
        return nextState.number % 10 !== 4;
    }
    componentWillUnmount(){
        console.log('componentWillUnmount')
    }
    handleClick = () => {
        this.setState({
            number : this.state.number + 1
        })
    }
    getSnapshotBeforeUpdate(prevProps, prevState){
        console.log('getSnapshotBeforeUpdate');
        if(prevProps.color !== this.props.color){
            return this.myRef.style.color;
        }
        return null;
    }
    componentDidUpdate(prevProps, prevStatem snapshot){
        console.log('componentDidUpdate', prevProps, prevState);
        if(snapshot){
            console.log('업데이트 되기직전 색상', snapshot);
        }
    }
    render(){
        console.log('render');
        const style = {
            color : this.state.color
        }
        return (
            <div>
                <h1 style={style} ref={ref => this.myRef=ref}>
                    {this.state.number}
                </h1>
                <p>color : {this.state.color}</p>
                <button onClick={this.handleClick}>
                    더하기
                </button>
            </div>
        )
    }
}
export default LifeCycleSample
```

이 컴포넌트는 각 라이플사이클 메서드를 실행할 때 마다 콘솔을 기록하고, 부모 컴포넌트에서 props로 색상을 받아 버튼을 누르면 state.number 값을 1씩 더합니다.

getDerivedStateProps는 부모에게서 받은 color 가 state에 동기화하고 있습니다.

그리고 getSnapshotBeforeUpdate는 DOM에 변화가 일어나기 직전에 색상 속성을 snapshot 값으로 반환하며 이것을 componentDidUpdate에서 조회할 수 있게 했습니다.

추가로 shouldComponentUpdate 메서드에서 state.number 값의 마지막 자릿수가 4면 리렌더링을 취소하도록 설정했습니다.

# 7.3.2 App 컴포넌트에서 예저 컴포넌트 사용

```js
// App.js
import React , {Component} from 'react';
import LifeCycleSample from './LifeCycleSample';

function getRandomColor(){
    return '#' + Math.floor(Math.random() * 16777215).toString(16);
}
class App extends Component {
    state = {
        color : '#000000'
    }
    handleClick = () => {
        this.setState({
            color : getRandomColor()
        })
    }
    render(){
        return (
            <div>
                <button onClick={this.handleClick}>랜덤 색상</button>
                <LifeCycleSample color={this.state.colro}/>
            </div>
        )
    }
}
export default App;
```

getRandomColor 함수는 state의 color 값을 랜덤 색상을 설정합니다. 16777215를 hex로 표현하면 ffffff가 되므로 해당 코드는 000000 부터 ffffff 값을 반환합니다.

버튼을 렌더링하고, 누를 때마다 handleClick 메서드가 호출되게 이벤트를 설정하며, 불러온 LifeCycleSample 컴포넌트에 color 값을 props로 설정합니다.

# 7.4 정리

라이프사이클 메서드는 컴포넌트 상태에 변화가 있을 때마다 실행하는 메서드입니다.

이 메서드들은 서드파티 라이브러리를 사용하거나 DOM을 직접 건드려야 하는 상황에서 유용합니다.

추가로 컴포넌트 업데이트의 성능을 개선할 때는 shouldComponentUpdate가 중요하게 사용됩니다.


