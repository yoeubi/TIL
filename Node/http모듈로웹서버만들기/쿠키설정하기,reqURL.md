# 쿠키 설정하기, req.url

```js
const http = require('http');

const parseCookies = (cookie = '') => {
    return cookie
        .split(';')
        .map( v => v.split('='))
        .map( ([k , ...vs]) => [k, vs.join('=')])
        .reduce( (acc , [k,v]) => {
            acc[k.trim()] = decodeURIComponent(v);
            return acc;
        } , {} );
}

const server = http.createServer( (req,res) => {
    console.log('서버 실행');
    console.log(req.url , parseCookies(req.headers.cookie));
    res.writeHead(200, {'Set-Cookie' : 'mycooki=test'});
    res.end('Hello Cookie');
}).listen(8080);
server.on('listening', () => {
    console.log('8080번 포트에서 서버 대기중입니다.')
})
server.on('error', (error) => {
    console.error(error);
})
```
- 클라이언트와 서버간의 데이터를 주고 받는 방법에 대해서 알아본다. 가장 간단한 방식이 쿠키와 세션이다. 

- 쿠키는 요청에 쿠키값을 넣어주면 서버가 클라이언트로 클라이언트에서 서버로 왔다 갔다 한다.

- 쿠키를 보내는 법은 헤더에 넣는 방법이 있다. `writeHead`의 `200`은 응답코드, 성공한 요청이라고 알려주는 것이다.

- 응답을 허용할수 있는데 200을 보내주면 클라이언트가 요청이 성공했구나 실패하면 400번대 500번대를 보낸다 브라우저가 요청을 실패했구나 하고 알아듣는다.

- 두번쨰 인자로 객체를 넣는다 이부분이 헤더부분인데 `Set-Cookie`가 쿠키를 설정하라는 것이며 값은 쿠키내용이다. 키-값 형식이다. 

- 서버에서 클라이언트로 데이터를 보내는 것이다. 브라우저가 받아서 이것을 받아서 쿠키를 만들어야 겠다 하고 브라우저가 쿠키를 저장한다. 

- 쿠키는 애플리케이션 스토리지 에서 찾을 수 있다.

- `요청이나 응답에는 그에 대한 정보를 담고 있는 헤더가 포함되어 있습니다.`

- 요청을 보낼때 요청에 대한 정보가 담긴 리퀘스트헤더가 있다. 이제는 클라이언트로 서버로 데이터를 보내는 것이다. 쿠키를 항상 같이 보낸다.

- 요청에 있다는 것은 클라이언트에서 서버로 요청을 보낼때 쿠키를 같이 껴서 보낸다는 의미이다.

- 서버에서 쿠키를 받는 법은 리퀘스트헤더스쿠키 에 있다. 하나의 문자열로 들어온다. 

- 문자열이니까 쓸수 있는 객체로 만드는게 `parseCookie`이다. 그러면 문자열이 객체로 바뀐다.

- `req.url` 은 어떤 주소로 사용자가 요청했는지를 알수 가 있다. `/`은 로컬호스트로 들어온것이다. 

- 파비콘은 크롬에서 자동으로 보내는 것이다. 

- `req.url`, 쿠키파싱을 왜 했나면 이것들을 통해서 다른 페이지를 보내줄 수 있다. 

- 루트주소가 블로그 주소가 뜬다. 카테고리 자바스크립트 치면 다른 페이지가 뜬다. 이 `req.url`를 통해서 보이는 페이지를 다르게 만들수 있다.